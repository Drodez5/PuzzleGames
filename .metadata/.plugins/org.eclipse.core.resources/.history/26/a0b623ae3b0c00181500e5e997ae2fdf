package dad.puzzlegames.controllers;

import java.io.IOException;

import java.util.Optional;


import dad.puzzlegames.views.PuzzleGamesApp;
import javafx.event.ActionEvent;

import javafx.scene.control.Alert;
import javafx.scene.control.Alert.AlertType;
import javafx.scene.control.ButtonBar.ButtonData;
import javafx.scene.control.ButtonType;
import javafx.scene.control.Dialog;
import javafx.scene.image.ImageView;
import javafx.scene.layout.BorderPane;
import javafx.stage.Modality;
import javafx.stage.Stage;

public class PuzzleGamesController {

	private MenuController controladorMenu;
	private OpcionesPartidaController controladorOpciones;
	private MarcadorController controladorMarcador;
	private BorderPane vista;
	private Stage appStage;

	public PuzzleGamesController() throws IOException {
		appStage = PuzzleGamesApp.getPrimaryStage();
		
		controladorMenu = new MenuController();
		controladorOpciones = new OpcionesPartidaController();
		controladorMarcador = new MarcadorController();
		vista = new BorderPane();
		vista.setCenter(controladorMenu.getVista());
		controladorMenu.getJugarButton().setOnAction(e -> onOpcionesPartidaButtonAction(e));
		controladorMenu.getMarcadorButton().setOnAction(e -> onMarcadorButtonAction(e));
		controladorMenu.getAcercaDeButton().setOnAction(e -> onAcercaDeButtonAction(e));
		controladorMenu.getSalirButton().setOnAction(e -> onSalirButtonAction(e));
		controladorOpciones.getAtrasButton().setOnAction(e->onAtrasButtonAction(e));
		controladorOpciones.getAbrirButton().setOnAction(e->onAbrirButtonAction(e));
		controladorMarcador.getVolverButton().setOnAction(e->onAtrasButtonAction(e));

	}

	private void onAbrirButtonAction(ActionEvent e) {
		
	
	}

	private void onAtrasButtonAction(ActionEvent e) {
		volverAMenu();	
	}

	private void onMarcadorButtonAction(ActionEvent e) {
		vista.setCenter(controladorMarcador.getVista());

	}

	// METODO SALIR
	private void onSalirButtonAction(ActionEvent e) {
		Alert alertExit = new Alert(AlertType.CONFIRMATION);
		alertExit.setTitle("PuzzleGames");
		alertExit.setHeaderText("Saliendo de PuzzleGames");
		alertExit.initOwner(appStage);
		alertExit.initModality(Modality.APPLICATION_MODAL);
		alertExit.setContentText("¿Seguro que quiere salir?");

		Optional<ButtonType> result = alertExit.showAndWait();
		if (result.get() == ButtonType.OK) {
			appStage.close();
		}

		

	}

	private void onAcercaDeButtonAction(ActionEvent e) {
		Dialog<Void> dialog = new Dialog<>();
		dialog.setTitle("About...");
		dialog.initOwner(appStage);
		dialog.setContentText("Desarrollador:\n" + "Domingo Rodríguez");
		dialog.setGraphic(new ImageView(getClass().getResource("/dad/puzzlegames/resources/developer.png").toExternalForm()));
		ButtonType ok = new ButtonType("OK", ButtonData.CANCEL_CLOSE);
		dialog.getDialogPane().getButtonTypes().add(ok);
		dialog.showAndWait();


	}

	private void onOpcionesPartidaButtonAction(ActionEvent e) {
		vista.setCenter(controladorOpciones.getVista());

	}
	
	private void volverAMenu() {
		vista.setCenter(controladorMenu.getVista());
	}

	public BorderPane getVista() {
		return vista;
	}

	public void setVista(BorderPane vista) {
		this.vista = vista;
	}

}
